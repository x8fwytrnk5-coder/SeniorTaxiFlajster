<!DOCTYPE html>
<html lang="sk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dispečing – GoralSoft</title>

<style>
  body {
    margin: 0;
    padding: 16px;
    font-family: system-ui, sans-serif;
    background: #0d1018;
    color: #f5f5f5;
  }

  h1 {
    margin-top: 0;
    font-size: 22px;
  }

  .section {
    background: #111522;
    padding: 14px;
    border-radius: 12px;
    border: 1px solid #33384a;
    margin-bottom: 16px;
  }

  .order {
    background: #181c28;
    padding: 12px;
    border-radius: 10px;
    border: 1px solid #33384a;
    margin-bottom: 10px;
  }

  .order h3 {
    margin: 0 0 6px;
    font-size: 16px;
  }

  button {
    padding: 10px 14px;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    font-weight: 600;
    background: linear-gradient(135deg, #3ddcff, #00ffa3);
    color: #000;
    margin-top: 10px;
  }

  input, select {
    width: 100%;
    padding: 10px;
    border-radius: 10px;
    border: 1px solid #33384a;
    background: #111522;
    color: #fff;
    margin-bottom: 10px;
  }

  .history-item {
    padding: 10px;
    border-bottom: 1px solid #222633;
  }
</style>
</head>

<body>
	<div style="
  display:flex;
  gap:10px;
  margin-bottom:20px;
  padding:10px;
  background:#111522;
  border-radius:12px;
  border:1px solid #33384a;
  position:sticky;
  top:0;
  z-index:999;
">
  <button onclick="location.href='index.html'" style="flex:1;padding:12px;border-radius:10px;border:none;background:#3ddcff;color:#000;font-weight:600;">Domov</button>
  <button onclick="location.href='client.html'" style="flex:1;padding:12px;border-radius:10px;border:none;background:#00ffa3;color:#000;font-weight:600;">Klient</button>
  <button onclick="location.href='driver.html'" style="flex:1;padding:12px;border-radius:10px;border:none;background:#ffd54f;color:#000;font-weight:600;">Vodič</button>
  <button onclick="location.href='dispatch.html'" style="flex:1;padding:12px;border-radius:10px;border:none;background:#ff5252;color:#000;font-weight:600;">Dispečing</button>
</div>


<h1>Dispečing</h1>

<!-- Sekcia: Nová objednávka -->
<div class="section">
  <h2>Vytvoriť novú objednávku</h2>

  <input type="text" id="newPickup" placeholder="Nástup">
  <input type="text" id="newDropoff" placeholder="Výstup">
  <input type="number" id="newDistance" placeholder="Vzdialenosť (km)">
  <input type="number" id="newPrice" placeholder="Cena (€)">

  <button id="createOrderBtn">Vytvoriť objednávku</button>
</div>

<!-- Sekcia: Aktívne objednávky -->
<div class="section">
  <h2>Aktívne objednávky</h2>
  <div id="orders"></div>
</div>

<!-- Sekcia: História -->
<div class="section">
  <h2>História</h2>
  <div id="history"></div>
</div>

<script>
// Simulované objednávky
let orders = [
  {
    id: 101,
    pickup: "Krupina, centrum",
    dropoff: "Zvolen, nemocnica",
    distance: 23.4,
    price: 19.89,
    assigned: null
  },
  {
    id: 102,
    pickup: "Zvolen, Sekier",
    dropoff: "Dobrá Niva",
    distance: 12.1,
    price: 10.28,
    assigned: null
  }
];

// Simulovaní vodiči
let drivers = ["Ján", "Peter", "Marek", "Štefan"];

// História
let history = [];

const ordersEl = document.getElementById("orders");
const historyEl = document.getElementById("history");

function renderOrders() {
  ordersEl.innerHTML = "";

  if (orders.length === 0) {
    ordersEl.innerHTML = "<p>Žiadne aktívne objednávky.</p>";
    return;
  }

  orders.forEach(order => {
    const div = document.createElement("div");
    div.className = "order";

    const driverSelect = drivers
      .map(d => `<option value="${d}">${d}</option>`)
      .join("");

    div.innerHTML = `
      <h3>Objednávka #${order.id}</h3>
      <div><strong>Nástup:</strong> ${order.pickup}</div>
      <div><strong>Výstup:</strong> ${order.dropoff}</div>
      <div><strong>Vzdialenosť:</strong> ${order.distance} km</div>
      <div><strong>Cena:</strong> ${order.price.toFixed(2)} €</div>

      <label>Priradiť vodiča:</label>
      <select id="driver_${order.id}">
        <option value="">-- vyberte vodiča --</option>
        ${driverSelect}
      </select>

      <button onclick="assignDriver(${order.id})">Priradiť</button>
    `;

    ordersEl.appendChild(div);
  });
}

function renderHistory() {
  historyEl.innerHTML = "";

  if (history.length === 0) {
    historyEl.innerHTML = "<p>Žiadne ukončené jazdy.</p>";
    return;
  }

  history.forEach(item => {
    const div = document.createElement("div");
    div.className = "history-item";
    div.innerHTML = `
      <strong>Objednávka #${item.id}</strong><br>
      ${item.pickup} → ${item.dropoff}<br>
      Vodič: ${item.driver}<br>
      Cena: ${item.price.toFixed(2)} €
    `;
    historyEl.appendChild(div);
  });
}

function assignDriver(id) {
  const order = orders.find(o => o.id === id);
  if (!order) return;

  const select = document.getElementById(`driver_${id}`);
  const driver = select.value;

  if (!driver) {
    alert("Vyberte vodiča.");
    return;
  }

  order.assigned = driver;

  // Presun do histórie
  history.push({
    id: order.id,
    pickup: order.pickup,
    dropoff: order.dropoff,
    price: order.price,
    driver
  });

  // Odstrániť z aktívnych
  orders = orders.filter(o => o.id !== id);

  renderOrders();
  renderHistory();
}

// Vytvorenie novej objednávky
document.getElementById("createOrderBtn").onclick = () => {
  const pickup = document.getElementById("newPickup").value.trim();
  const dropoff = document.getElementById("newDropoff").value.trim();
  const distance = parseFloat(document.getElementById("newDistance").value);
  const price = parseFloat(document.getElementById("newPrice").value);

  if (!pickup || !dropoff || isNaN(distance) || isNaN(price)) {
    alert("Vyplňte všetky údaje.");
    return;
  }

  const newOrder = {
    id: Math.floor(Math.random() * 9000 + 1000),
    pickup,
    dropoff,
    distance,
    price,
    assigned: null
  };

  orders.push(newOrder);

  document.getElementById("newPickup").value = "";
  document.getElementById("newDropoff").value = "";
  document.getElementById("newDistance").value = "";
  document.getElementById("newPrice").value = "";

  renderOrders();
};

renderOrders();
renderHistory();
</script>

</body>
</html>
